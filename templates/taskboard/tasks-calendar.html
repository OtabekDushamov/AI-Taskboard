<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Task Calendar</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --high-priority: #f87171;
            --medium-priority: #fbbf24;
            --low-priority: #34d399;
            --default-priority: #60a5fa;
        }

        .calendar-grid {
            display: grid;
            grid-template-columns: repeat(7, 1fr);
            gap: 1px;
        }

        .calendar-day {
            min-height: 100px;
            border: 1px solid #e5e7eb;
            position: relative;
        }

        .calendar-day-header {
            text-align: right;
            padding: 4px;
            font-size: 0.875rem;
        }

        .calendar-event {
            font-size: 0.75rem;
            padding: 2px 4px;
            margin: 2px;
            border-radius: 4px;
            cursor: pointer;
            overflow: hidden;
            text-overflow: ellipsis;
            white-space: nowrap;
        }

        .high-priority {
            background-color: var(--high-priority);
            color: white;
        }

        .medium-priority {
            background-color: var(--medium-priority);
            color: white;
        }

        .low-priority {
            background-color: var(--low-priority);
            color: white;
        }

        .default-priority {
            background-color: var(--default-priority);
            color: white;
        }

        .today {
            background-color: #dbeafe;
        }

        .current-day {
            background-color: #3b82f6;
            color: white;
            border-radius: 50%;
            width: 24px;
            height: 24px;
            display: inline-flex;
            align-items: center;
            justify-content: center;
        }

        .drawer {
            transform: translateX(100%);
            transition: transform 0.3s ease-in-out;
        }

        .drawer-open {
            transform: translateX(0);
        }

        .week-view .calendar-day {
            min-height: 600px;
        }

        .day-view .calendar-day {
            min-height: 800px;
        }

        @media (max-width: 768px) {
            .calendar-container {
                flex-direction: column;
            }
            .sidebar {
                width: 100%;
                order: -1;
            }
            .main-content {
                width: 100%;
            }
            .view-options {
                flex-wrap: wrap;
            }
        }

        .draggable {
            cursor: move;
        }

        .dropzone {
            border: 2px dashed #3b82f6;
            background-color: rgba(59, 130, 246, 0.1);
        }
    </style>
</head>
<body class="bg-gray-50">
    <div class="flex h-screen overflow-hidden">
        <!-- Sidebar -->
        <div class="sidebar w-64 bg-white border-r border-gray-200 p-4 flex flex-col">
            <h1 class="text-xl font-bold mb-6">Task Calendar</h1>
            
            <!-- Mini Calendar -->
            <div class="mb-6">
                <div class="flex justify-between items-center mb-2">
                    <button class="text-gray-500 hover:text-gray-700" id="prev-month">
                        <i class="fas fa-chevron-left"></i>
                    </button>
                    <h3 class="font-semibold" id="mini-calendar-month">June 2023</h3>
                    <button class="text-gray-500 hover:text-gray-700" id="next-month">
                        <i class="fas fa-chevron-right"></i>
                    </button>
                </div>
                <div class="grid grid-cols-7 gap-1 text-center text-xs mb-1">
                    <div>S</div>
                    <div>M</div>
                    <div>T</div>
                    <div>W</div>
                    <div>T</div>
                    <div>F</div>
                    <div>S</div>
                </div>
                <div class="grid grid-cols-7 gap-1 text-center text-sm" id="mini-calendar-days"></div>
            </div>
            
            <!-- Filters -->
            <div class="mb-6">
                <h3 class="font-semibold mb-2">Filters</h3>
                <div class="space-y-3">
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">Project</label>
                        <select class="w-full border border-gray-300 rounded-md px-2 py-1 text-sm">
                            <option>All Projects</option>
                            <option>Website Redesign</option>
                            <option>Marketing Campaign</option>
                            <option>Product Development</option>
                        </select>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">Assignee</label>
                        <select class="w-full border border-gray-300 rounded-md px-2 py-1 text-sm">
                            <option>All Team</option>
                            <option>John Doe</option>
                            <option>Jane Smith</option>
                            <option>Mike Johnson</option>
                        </select>
                    </div>
                    <div>
                        <label class="block text-sm font-medium text-gray-700 mb-1">Status</label>
                        <select class="w-full border border-gray-300 rounded-md px-2 py-1 text-sm">
                            <option>All Statuses</option>
                            <option>Not Started</option>
                            <option>In Progress</option>
                            <option>Completed</option>
                        </select>
                    </div>
                </div>
            </div>
            
            <!-- Quick Add -->
            <button class="bg-blue-500 hover:bg-blue-600 text-white py-2 px-4 rounded-md flex items-center justify-center">
                <i class="fas fa-plus mr-2"></i> Add Task
            </button>
        </div>
        
        <!-- Main Content -->
        <div class="main-content flex-1 overflow-auto p-6">
            <div class="flex justify-between items-center mb-6">
                <div>
                    <h2 class="text-2xl font-bold" id="current-month">June 2023</h2>
                    <button class="text-blue-500 hover:text-blue-700 text-sm" id="today-btn">Today</button>
                </div>
                
                <div class="flex space-x-2 view-options">
                    <button class="px-4 py-2 rounded-md bg-blue-500 text-white" id="month-view">Month</button>
                    <button class="px-4 py-2 rounded-md border border-gray-300 hover:bg-gray-100" id="week-view">Week</button>
                    <button class="px-4 py-2 rounded-md border border-gray-300 hover:bg-gray-100" id="day-view">Day</button>
                </div>
                
                <div class="flex space-x-2">
                    <button class="p-2 rounded-full hover:bg-gray-100" id="prev-period">
                        <i class="fas fa-chevron-left"></i>
                    </button>
                    <button class="p-2 rounded-full hover:bg-gray-100" id="next-period">
                        <i class="fas fa-chevron-right"></i>
                    </button>
                </div>
            </div>
            
            <!-- Month View (Default) -->
            <div id="month-calendar" class="calendar-view">
                <div class="grid grid-cols-7 gap-1 text-center bg-gray-100 py-2 font-medium">
                    <div>Sunday</div>
                    <div>Monday</div>
                    <div>Tuesday</div>
                    <div>Wednesday</div>
                    <div>Thursday</div>
                    <div>Friday</div>
                    <div>Saturday</div>
                </div>
                <div class="calendar-grid" id="month-days"></div>
            </div>
            
            <!-- Week View (Hidden by default) -->
            <div id="week-calendar" class="calendar-view hidden">
                <div class="grid grid-cols-7 gap-1 text-center bg-gray-100 py-2 font-medium">
                    <div>Sunday<br><span id="week-sun-date">28</span></div>
                    <div>Monday<br><span id="week-mon-date">29</span></div>
                    <div>Tuesday<br><span id="week-tue-date">30</span></div>
                    <div>Wednesday<br><span id="week-wed-date">31</span></div>
                    <div>Thursday<br><span id="week-thu-date">1</span></div>
                    <div>Friday<br><span id="week-fri-date">2</span></div>
                    <div>Saturday<br><span id="week-sat-date">3</span></div>
                </div>
                <div class="calendar-grid week-view" id="week-days"></div>
            </div>
            
            <!-- Day View (Hidden by default) -->
            <div id="day-calendar" class="calendar-view hidden">
                <div class="text-center bg-gray-100 py-2 font-medium">
                    <div>Wednesday, June 7, 2023</div>
                </div>
                <div class="calendar-grid day-view">
                    <div class="calendar-day" id="day-view-day">
                        <div class="calendar-day-header">
                            <span class="current-day">7</span>
                        </div>
                        <div id="day-events"></div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Task Details Drawer -->
        <div class="drawer fixed inset-y-0 right-0 w-96 bg-white shadow-lg z-10 p-6 overflow-y-auto" id="task-drawer">
            <div class="flex justify-between items-center mb-4">
                <h3 class="text-lg font-bold">Task Details</h3>
                <button class="text-gray-500 hover:text-gray-700" id="close-drawer">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            
            <div class="mb-4">
                <h4 class="font-semibold text-xl" id="task-title">Task Title</h4>
                <div class="flex items-center mt-1">
                    <span class="text-sm text-gray-500" id="task-date">Jun 7, 2023</span>
                    <span class="mx-2 text-gray-300">|</span>
                    <span class="text-sm" id="task-priority">High Priority</span>
                </div>
            </div>
            
            <div class="mb-6">
                <p class="text-gray-700" id="task-description">Task description goes here with all the details about what needs to be done for this task.</p>
            </div>
            
            <div class="space-y-4 mb-6">
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">Project</label>
                    <p class="text-sm" id="task-project">Website Redesign</p>
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">Assignee</label>
                    <p class="text-sm" id="task-assignee">John Doe</p>
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">Status</label>
                    <select class="w-full border border-gray-300 rounded-md px-2 py-1 text-sm" id="task-status">
                        <option>Not Started</option>
                        <option>In Progress</option>
                        <option>Completed</option>
                    </select>
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">Priority</label>
                    <select class="w-full border border-gray-300 rounded-md px-2 py-1 text-sm" id="task-priority-select">
                        <option value="high">High</option>
                        <option value="medium">Medium</option>
                        <option value="low">Low</option>
                    </select>
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-700 mb-1">Due Date</label>
                    <input type="date" class="w-full border border-gray-300 rounded-md px-2 py-1 text-sm" id="task-due-date">
                </div>
            </div>
            
            <div class="flex space-x-2">
                <button class="flex-1 bg-blue-500 hover:bg-blue-600 text-white py-2 px-4 rounded-md">
                    Save Changes
                </button>
                <button class="flex-1 bg-red-500 hover:bg-red-600 text-white py-2 px-4 rounded-md">
                    Delete Task
                </button>
            </div>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Current date
            let currentDate = new Date();
            let currentMonth = currentDate.getMonth();
            let currentYear = currentDate.getFullYear();
            let currentDay = currentDate.getDate();
            
            // View state
            let currentView = 'month';
            
            // Sample tasks data
            const tasks = [
                {
                    id: 1,
                    title: 'Design Homepage',
                    description: 'Create new design for the homepage with updated branding',
                    project: 'Website Redesign',
                    assignee: 'John Doe',
                    status: 'In Progress',
                    priority: 'high',
                    dueDate: new Date(currentYear, currentMonth, 5)
                },
                {
                    id: 2,
                    title: 'Write Blog Post',
                    description: 'Write 1000-word blog post about new product features',
                    project: 'Marketing Campaign',
                    assignee: 'Jane Smith',
                    status: 'Not Started',
                    priority: 'medium',
                    dueDate: new Date(currentYear, currentMonth, 12)
                },
                {
                    id: 3,
                    title: 'Team Meeting',
                    description: 'Weekly team sync to discuss project progress',
                    project: 'Product Development',
                    assignee: 'Mike Johnson',
                    status: 'Completed',
                    priority: 'low',
                    dueDate: new Date(currentYear, currentMonth, 15)
                },
                {
                    id: 4,
                    title: 'User Testing',
                    description: 'Conduct user testing sessions for new feature',
                    project: 'Product Development',
                    assignee: 'Jane Smith',
                    status: 'In Progress',
                    priority: 'high',
                    dueDate: new Date(currentYear, currentMonth, 20)
                },
                {
                    id: 5,
                    title: 'API Documentation',
                    description: 'Update API documentation for new endpoints',
                    project: 'Website Redesign',
                    assignee: 'John Doe',
                    status: 'Not Started',
                    priority: 'medium',
                    dueDate: new Date(currentYear, currentMonth, 25)
                }
            ];
            
            // DOM Elements
            const monthDaysEl = document.getElementById('month-days');
            const weekDaysEl = document.getElementById('week-days');
            const dayEventsEl = document.getElementById('day-events');
            const currentMonthEl = document.getElementById('current-month');
            const miniCalendarMonthEl = document.getElementById('mini-calendar-month');
            const miniCalendarDaysEl = document.getElementById('mini-calendar-days');
            const taskDrawerEl = document.getElementById('task-drawer');
            
            // View buttons
            const monthViewBtn = document.getElementById('month-view');
            const weekViewBtn = document.getElementById('week-view');
            const dayViewBtn = document.getElementById('day-view');
            
            // Navigation buttons
            const prevMonthBtn = document.getElementById('prev-month');
            const nextMonthBtn = document.getElementById('next-month');
            const prevPeriodBtn = document.getElementById('prev-period');
            const nextPeriodBtn = document.getElementById('next-period');
            const todayBtn = document.getElementById('today-btn');
            
            // Drawer elements
            const closeDrawerBtn = document.getElementById('close-drawer');
            const taskTitleEl = document.getElementById('task-title');
            const taskDateEl = document.getElementById('task-date');
            const taskPriorityEl = document.getElementById('task-priority');
            const taskDescriptionEl = document.getElementById('task-description');
            const taskProjectEl = document.getElementById('task-project');
            const taskAssigneeEl = document.getElementById('task-assignee');
            const taskStatusEl = document.getElementById('task-status');
            const taskPrioritySelectEl = document.getElementById('task-priority-select');
            const taskDueDateEl = document.getElementById('task-due-date');
            
            // Initialize calendar
            renderMonthCalendar(currentMonth, currentYear);
            renderMiniCalendar(currentMonth, currentYear);
            updateWeekViewDates();
            renderDayEvents(currentDay, currentMonth, currentYear);
            
            // Event listeners
            monthViewBtn.addEventListener('click', () => switchView('month'));
            weekViewBtn.addEventListener('click', () => switchView('week'));
            dayViewBtn.addEventListener('click', () => switchView('day'));
            
            prevMonthBtn.addEventListener('click', () => {
                currentMonth--;
                if (currentMonth < 0) {
                    currentMonth = 11;
                    currentYear--;
                }
                renderMiniCalendar(currentMonth, currentYear);
            });
            
            nextMonthBtn.addEventListener('click', () => {
                currentMonth++;
                if (currentMonth > 11) {
                    currentMonth = 0;
                    currentYear++;
                }
                renderMiniCalendar(currentMonth, currentYear);
            });
            
            prevPeriodBtn.addEventListener('click', navigatePrevious);
            nextPeriodBtn.addEventListener('click', navigateNext);
            todayBtn.addEventListener('click', goToToday);
            
            closeDrawerBtn.addEventListener('click', closeTaskDrawer);
            
            // Functions
            function renderMonthCalendar(month, year) {
                monthDaysEl.innerHTML = '';
                
                const firstDay = new Date(year, month, 1).getDay();
                const daysInMonth = new Date(year, month + 1, 0).getDate();
                const daysInPrevMonth = new Date(year, month, 0).getDate();
                
                // Update month/year display
                const monthNames = ['January', 'February', 'March', 'April', 'May', 'June', 'July', 'August', 'September', 'October', 'November', 'December'];
                currentMonthEl.textContent = `${monthNames[month]} ${year}`;
                
                // Previous month days
                for (let i = firstDay - 1; i >= 0; i--) {
                    const dayEl = document.createElement('div');
                    dayEl.className = 'calendar-day bg-gray-50 text-gray-400';
                    dayEl.innerHTML = `<div class="calendar-day-header">${daysInPrevMonth - i}</div>`;
                    monthDaysEl.appendChild(dayEl);
                }
                
                // Current month days
                for (let i = 1; i <= daysInMonth; i++) {
                    const dayEl = document.createElement('div');
                    dayEl.className = 'calendar-day';
                    
                    // Check if this is today
                    const isToday = i === currentDay && month === new Date().getMonth() && year === new Date().getFullYear();
                    if (isToday) {
                        dayEl.classList.add('today');
                    }
                    
                    dayEl.innerHTML = `
                        <div class="calendar-day-header">
                            ${i === currentDay && month === new Date().getMonth() && year === new Date().getFullYear() 
                                ? `<span class="current-day">${i}</span>` 
                                : i}
                        </div>
                    `;
                    
                    // Add tasks for this day
                    const dayTasks = tasks.filter(task => 
                        task.dueDate.getDate() === i && 
                        task.dueDate.getMonth() === month && 
                        task.dueDate.getFullYear() === year
                    );
                    
                    dayTasks.forEach(task => {
                        const taskEl = document.createElement('div');
                        taskEl.className = `calendar-event ${task.priority}-priority draggable`;
                        taskEl.textContent = task.title;
                        taskEl.dataset.taskId = task.id;
                        
                        // Add click event to show task details
                        taskEl.addEventListener('click', () => showTaskDetails(task.id));
                        
                        // Make task draggable
                        taskEl.draggable = true;
                        taskEl.addEventListener('dragstart', (e) => {
                            e.dataTransfer.setData('text/plain', task.id);
                            e.dataTransfer.effectAllowed = 'move';
                        });
                        
                        dayEl.appendChild(taskEl);
                    });
                    
                    // Make day a drop target
                    dayEl.addEventListener('dragover', (e) => {
                        e.preventDefault();
                        dayEl.classList.add('dropzone');
                    });
                    
                    dayEl.addEventListener('dragleave', () => {
                        dayEl.classList.remove('dropzone');
                    });
                    
                    dayEl.addEventListener('drop', (e) => {
                        e.preventDefault();
                        dayEl.classList.remove('dropzone');
                        
                        const taskId = e.dataTransfer.getData('text/plain');
                        const task = tasks.find(t => t.id == taskId);
                        
                        if (task) {
                            // Update task due date
                            task.dueDate = new Date(year, month, i);
                            
                            // Re-render calendar
                            if (currentView === 'month') {
                                renderMonthCalendar(currentMonth, currentYear);
                            } else if (currentView === 'week') {
                                renderWeekCalendar();
                            } else {
                                renderDayEvents(currentDay, currentMonth, currentYear);
                            }
                        }
                    });
                    
                    monthDaysEl.appendChild(dayEl);
                }
                
                // Next month days
                const totalCells = firstDay + daysInMonth;
                const remainingCells = 42 - totalCells; // 6 rows x 7 days
                
                if (remainingCells > 0) {
                    for (let i = 1; i <= remainingCells; i++) {
                        const dayEl = document.createElement('div');
                        dayEl.className = 'calendar-day bg-gray-50 text-gray-400';
                        dayEl.innerHTML = `<div class="calendar-day-header">${i}</div>`;
                        monthDaysEl.appendChild(dayEl);
                    }
                }
            }
            
            function renderWeekCalendar() {
                weekDaysEl.innerHTML = '';
                
                // For simplicity, we'll just show the current week
                const weekStart = new Date(currentYear, currentMonth, currentDay - new Date().getDay());
                
                for (let i = 0; i < 7; i++) {
                    const dayDate = new Date(weekStart);
                    dayDate.setDate(weekStart.getDate() + i);
                    
                    const dayEl = document.createElement('div');
                    dayEl.className = 'calendar-day';
                    
                    // Check if this is today
                    const isToday = dayDate.getDate() === new Date().getDate() && 
                                    dayDate.getMonth() === new Date().getMonth() && 
                                    dayDate.getFullYear() === new Date().getFullYear();
                    if (isToday) {
                        dayEl.classList.add('today');
                    }
                    
                    // Add tasks for this day
                    const dayTasks = tasks.filter(task => 
                        task.dueDate.getDate() === dayDate.getDate() && 
                        task.dueDate.getMonth() === dayDate.getMonth() && 
                        task.dueDate.getFullYear() === dayDate.getFullYear()
                    );
                    
                    dayTasks.forEach(task => {
                        const taskEl = document.createElement('div');
                        taskEl.className = `calendar-event ${task.priority}-priority draggable`;
                        taskEl.textContent = `${task.title} - ${task.project}`;
                        taskEl.dataset.taskId = task.id;
                        
                        // Add click event to show task details
                        taskEl.addEventListener('click', () => showTaskDetails(task.id));
                        
                        // Make task draggable
                        taskEl.draggable = true;
                        taskEl.addEventListener('dragstart', (e) => {
                            e.dataTransfer.setData('text/plain', task.id);
                            e.dataTransfer.effectAllowed = 'move';
                        });
                        
                        dayEl.appendChild(taskEl);
                    });
                    
                    // Make day a drop target
                    dayEl.addEventListener('dragover', (e) => {
                        e.preventDefault();
                        dayEl.classList.add('dropzone');
                    });
                    
                    dayEl.addEventListener('dragleave', () => {
                        dayEl.classList.remove('dropzone');
                    });
                    
                    dayEl.addEventListener('drop', (e) => {
                        e.preventDefault();
                        dayEl.classList.remove('dropzone');
                        
                        const taskId = e.dataTransfer.getData('text/plain');
                        const task = tasks.find(t => t.id == taskId);
                        
                        if (task) {
                            // Update task due date
                            task.dueDate = new Date(dayDate);
                            
                            // Re-render calendar
                            if (currentView === 'month') {
                                renderMonthCalendar(currentMonth, currentYear);
                            } else if (currentView === 'week') {
                                renderWeekCalendar();
                            } else {
                                renderDayEvents(currentDay, currentMonth, currentYear);
                            }
                        }
                    });
                    
                    weekDaysEl.appendChild(dayEl);
                }
            }
            
            function renderDayEvents(day, month, year) {
                dayEventsEl.innerHTML = '';
                
                const dayTasks = tasks.filter(task => 
                    task.dueDate.getDate() === day && 
                    task.dueDate.getMonth() === month && 
                    task.dueDate.getFullYear() === year
                );
                
                if (dayTasks.length === 0) {
                    dayEventsEl.innerHTML = '<p class="text-gray-500 text-center mt-4">No tasks for this day</p>';
                    return;
                }
                
                dayTasks.forEach(task => {
                    const taskEl = document.createElement('div');
                    taskEl.className = `calendar-event ${task.priority}-priority mb-2 draggable`;
                    taskEl.innerHTML = `
                        <div class="font-semibold">${task.title}</div>
                        <div class="text-xs">${task.project} • ${task.assignee}</div>
                    `;
                    taskEl.dataset.taskId = task.id;
                    
                    // Add click event to show task details
                    taskEl.addEventListener('click', () => showTaskDetails(task.id));
                    
                    // Make task draggable
                    taskEl.draggable = true;
                    taskEl.addEventListener('dragstart', (e) => {
                        e.dataTransfer.setData('text/plain', task.id);
                        e.dataTransfer.effectAllowed = 'move';
                    });
                    
                    dayEventsEl.appendChild(taskEl);
                });
            }
            
            function renderMiniCalendar(month, year) {
                miniCalendarDaysEl.innerHTML = '';
                miniCalendarMonthEl.textContent = new Date(year, month).toLocaleDateString('en-US', { month: 'long', year: 'numeric' });
                
                const firstDay = new Date(year, month, 1).getDay();
                const daysInMonth = new Date(year, month + 1, 0).getDate();
                
                // Previous month days
                for (let i = firstDay - 1; i >= 0; i--) {
                    const dayEl = document.createElement('div');
                    dayEl.className = 'text-gray-400 text-xs p-1';
                    dayEl.textContent = '';
                    miniCalendarDaysEl.appendChild(dayEl);
                }
                
                // Current month days
                for (let i = 1; i <= daysInMonth; i++) {
                    const dayEl = document.createElement('div');
                    dayEl.className = 'text-xs p-1 cursor-pointer hover:bg-blue-100 rounded';
                    
                    // Check if this is today
                    const isToday = i === new Date().getDate() && month === new Date().getMonth() && year === new Date().getFullYear();
                    if (isToday) {
                        dayEl.className += ' bg-blue-500 text-white';
                    }
                    
                    dayEl.textContent = i;
                    dayEl.addEventListener('click', () => {
                        currentDay = i;
                        currentMonth = month;
                        currentYear = year;
                        goToDate(i, month, year);
                    });
                    
                    miniCalendarDaysEl.appendChild(dayEl);
                }
                
                // Next month days
                const totalCells = firstDay + daysInMonth;
                const remainingCells = 42 - totalCells;
                
                if (remainingCells > 0) {
                    for (let i = 1; i <= remainingCells; i++) {
                        const dayEl = document.createElement('div');
                        dayEl.className = 'text-gray-400 text-xs p-1';
                        dayEl.textContent = '';
                        miniCalendarDaysEl.appendChild(dayEl);
                    }
                }
            }
            
            function updateWeekViewDates() {
                const weekStart = new Date(currentYear, currentMonth, currentDay - new Date().getDay());
                
                document.getElementById('week-sun-date').textContent = weekStart.getDate();
                document.getElementById('week-mon-date').textContent = new Date(weekStart.getTime() + 24 * 60 * 60 * 1000).getDate();
                document.getElementById('week-tue-date').textContent = new Date(weekStart.getTime() + 2 * 24 * 60 * 60 * 1000).getDate();
                document.getElementById('week-wed-date').textContent = new Date(weekStart.getTime() + 3 * 24 * 60 * 60 * 1000).getDate();
                document.getElementById('week-thu-date').textContent = new Date(weekStart.getTime() + 4 * 24 * 60 * 60 * 1000).getDate();
                document.getElementById('week-fri-date').textContent = new Date(weekStart.getTime() + 5 * 24 * 60 * 60 * 1000).getDate();
                document.getElementById('week-sat-date').textContent = new Date(weekStart.getTime() + 6 * 24 * 60 * 60 * 1000).getDate();
            }
            
            function switchView(view) {
                currentView = view;
                
                // Hide all views
                document.querySelectorAll('.calendar-view').forEach(v => v.classList.add('hidden'));
                
                // Show selected view
                if (view === 'month') {
                    document.getElementById('month-calendar').classList.remove('hidden');
                    renderMonthCalendar(currentMonth, currentYear);
                } else if (view === 'week') {
                    document.getElementById('week-calendar').classList.remove('hidden');
                    renderWeekCalendar();
                } else if (view === 'day') {
                    document.getElementById('day-calendar').classList.remove('hidden');
                    renderDayEvents(currentDay, currentMonth, currentYear);
                }
                
                // Update view buttons
                monthViewBtn.className = view === 'month' ? 'px-4 py-2 rounded-md bg-blue-500 text-white' : 'px-4 py-2 rounded-md border border-gray-300 hover:bg-gray-100';
                weekViewBtn.className = view === 'week' ? 'px-4 py-2 rounded-md bg-blue-500 text-white' : 'px-4 py-2 rounded-md border border-gray-300 hover:bg-gray-100';
                dayViewBtn.className = view === 'day' ? 'px-4 py-2 rounded-md bg-blue-500 text-white' : 'px-4 py-2 rounded-md border border-gray-300 hover:bg-gray-100';
            }
            
            function navigatePrevious() {
                if (currentView === 'month') {
                    currentMonth--;
                    if (currentMonth < 0) {
                        currentMonth = 11;
                        currentYear--;
                    }
                    renderMonthCalendar(currentMonth, currentYear);
                    renderMiniCalendar(currentMonth, currentYear);
                } else if (currentView === 'week') {
                    currentDay -= 7;
                    if (currentDay < 1) {
                        currentMonth--;
                        if (currentMonth < 0) {
                            currentMonth = 11;
                            currentYear--;
                        }
                        currentDay = new Date(currentYear, currentMonth + 1, 0).getDate() + currentDay;
                    }
                    updateWeekViewDates();
                    renderWeekCalendar();
                } else if (currentView === 'day') {
                    currentDay--;
                    if (currentDay < 1) {
                        currentMonth--;
                        if (currentMonth < 0) {
                            currentMonth = 11;
                            currentYear--;
                        }
                        currentDay = new Date(currentYear, currentMonth + 1, 0).getDate();
                    }
                    renderDayEvents(currentDay, currentMonth, currentYear);
                }
            }
            
            function navigateNext() {
                if (currentView === 'month') {
                    currentMonth++;
                    if (currentMonth > 11) {
                        currentMonth = 0;
                        currentYear++;
                    }
                    renderMonthCalendar(currentMonth, currentYear);
                    renderMiniCalendar(currentMonth, currentYear);
                } else if (currentView === 'week') {
                    currentDay += 7;
                    const daysInMonth = new Date(currentYear, currentMonth + 1, 0).getDate();
                    if (currentDay > daysInMonth) {
                        currentDay -= daysInMonth;
                        currentMonth++;
                        if (currentMonth > 11) {
                            currentMonth = 0;
                            currentYear++;
                        }
                    }
                    updateWeekViewDates();
                    renderWeekCalendar();
                } else if (currentView === 'day') {
                    const daysInMonth = new Date(currentYear, currentMonth + 1, 0).getDate();
                    currentDay++;
                    if (currentDay > daysInMonth) {
                        currentDay = 1;
                        currentMonth++;
                        if (currentMonth > 11) {
                            currentMonth = 0;
                            currentYear++;
                        }
                    }
                    renderDayEvents(currentDay, currentMonth, currentYear);
                }
            }
            
            function goToToday() {
                const today = new Date();
                currentDay = today.getDate();
                currentMonth = today.getMonth();
                currentYear = today.getFullYear();
                
                if (currentView === 'month') {
                    renderMonthCalendar(currentMonth, currentYear);
                } else if (currentView === 'week') {
                    updateWeekViewDates();
                    renderWeekCalendar();
                } else {
                    renderDayEvents(currentDay, currentMonth, currentYear);
                }
                
                renderMiniCalendar(currentMonth, currentYear);
            }
            
            function goToDate(day, month, year) {
                currentDay = day;
                currentMonth = month;
                currentYear = year;
                
                if (currentView === 'month') {
                    renderMonthCalendar(currentMonth, currentYear);
                } else if (currentView === 'week') {
                    updateWeekViewDates();
                    renderWeekCalendar();
                } else {
                    renderDayEvents(currentDay, currentMonth, currentYear);
                }
                
                renderMiniCalendar(currentMonth, currentYear);
            }
            
            function showTaskDetails(taskId) {
                const task = tasks.find(t => t.id == taskId);
                if (!task) return;
                
                // Populate drawer with task details
                taskTitleEl.textContent = task.title;
                taskDateEl.textContent = task.dueDate.toLocaleDateString('en-US', { month: 'short', day: 'numeric', year: 'numeric' });
                taskPriorityEl.textContent = `${task.priority.charAt(0).toUpperCase() + task.priority.slice(1)} Priority`;
                taskDescriptionEl.textContent = task.description;
                taskProjectEl.textContent = task.project;
                taskAssigneeEl.textContent = task.assignee;
                taskStatusEl.value = task.status;
                taskPrioritySelectEl.value = task.priority;
                taskDueDateEl.value = task.dueDate.toISOString().split('T')[0];
                
                // Update priority color
                taskPriorityEl.className = `text-sm ${task.priority}-priority`;
                
                // Show drawer
                taskDrawerEl.classList.add('drawer-open');
            }
            
            function closeTaskDrawer() {
                taskDrawerEl.classList.remove('drawer-open');
            }
            
            // Filter functionality
            const projectFilter = document.querySelector('select:first-of-type');
            const assigneeFilter = document.querySelector('select:nth-of-type(2)');
            const statusFilter = document.querySelector('select:nth-of-type(3)');
            
            function applyFilters() {
                const project = projectFilter.value;
                const assignee = assigneeFilter.value;
                const status = statusFilter.value;
                
                // Filter tasks based on selections
                const filteredTasks = tasks.filter(task => {
                    if (project !== 'All Projects' && task.project !== project) return false;
                    if (assignee !== 'All Team' && task.assignee !== assignee) return false;
                    if (status !== 'All Statuses' && task.status !== status) return false;
                    return true;
                });
                
                // Re-render calendar with filtered tasks
                if (currentView === 'month') {
                    renderMonthCalendar(currentMonth, currentYear);
                } else if (currentView === 'week') {
                    renderWeekCalendar();
                } else {
                    renderDayEvents(currentDay, currentMonth, currentYear);
                }
            }
            
            // Add filter event listeners
            projectFilter.addEventListener('change', applyFilters);
            assigneeFilter.addEventListener('change', applyFilters);
            statusFilter.addEventListener('change', applyFilters);
            
            // Save changes functionality
            const saveChangesBtn = document.querySelector('button:contains("Save Changes")');
            if (saveChangesBtn) {
                saveChangesBtn.addEventListener('click', () => {
                    // Get current task ID from drawer
                    const taskTitle = taskTitleEl.textContent;
                    const task = tasks.find(t => t.title === taskTitle);
                    
                    if (task) {
                        // Update task properties
                        task.status = taskStatusEl.value;
                        task.priority = taskPrioritySelectEl.value;
                        task.dueDate = new Date(taskDueDateEl.value);
                        
                        // Re-render calendar
                        if (currentView === 'month') {
                            renderMonthCalendar(currentMonth, currentYear);
                        } else if (currentView === 'week') {
                            renderWeekCalendar();
                        } else {
                            renderDayEvents(currentDay, currentMonth, currentYear);
                        }
                        
                        // Close drawer
                        closeTaskDrawer();
                    }
                });
            }
            
            // Delete task functionality
            const deleteTaskBtn = document.querySelector('button:contains("Delete Task")');
            if (deleteTaskBtn) {
                deleteTaskBtn.addEventListener('click', () => {
                    const taskTitle = taskTitleEl.textContent;
                    const taskIndex = tasks.findIndex(t => t.title === taskTitle);
                    
                    if (taskIndex !== -1) {
                        tasks.splice(taskIndex, 1);
                        
                        // Re-render calendar
                        if (currentView === 'month') {
                            renderMonthCalendar(currentMonth, currentYear);
                        } else if (currentView === 'week') {
                            renderWeekCalendar();
                        } else {
                            renderDayEvents(currentDay, currentMonth, currentYear);
                        }
                        
                        // Close drawer
                        closeTaskDrawer();
                    }
                });
            }
            
            // Add task functionality
            const addTaskBtn = document.querySelector('button:contains("Add Task")');
            if (addTaskBtn) {
                addTaskBtn.addEventListener('click', () => {
                    // Simple add task - you can expand this with a modal
                    const newTask = {
                        id: Date.now(),
                        title: 'New Task',
                        description: 'Task description',
                        project: 'Website Redesign',
                        assignee: 'John Doe',
                        status: 'Not Started',
                        priority: 'medium',
                        dueDate: new Date()
                    };
                    
                    tasks.push(newTask);
                    
                    // Re-render calendar
                    if (currentView === 'month') {
                        renderMonthCalendar(currentMonth, currentYear);
                    } else if (currentView === 'week') {
                        renderWeekCalendar();
                    } else {
                        renderDayEvents(currentDay, currentMonth, currentYear);
                    }
                });
            }
            
            // Close drawer when clicking outside
            document.addEventListener('click', (e) => {
                if (!taskDrawerEl.contains(e.target) && !e.target.closest('.calendar-event')) {
                    closeTaskDrawer();
                }
            });
            
            // Keyboard shortcuts
            document.addEventListener('keydown', (e) => {
                if (e.key === 'Escape') {
                    closeTaskDrawer();
                }
            });
        });
    </script>
</body>
</html>